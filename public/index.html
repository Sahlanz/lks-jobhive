<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>JobHive ‚Äî Find Your Dream Job</title>
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body { font-family: 'Segoe UI', Arial, sans-serif; background: #f8fafc; color: #1e293b; }

    nav { background: #1e293b; padding: 0 2rem;
          display: flex; justify-content: space-between; align-items: center;
          position: sticky; top: 0; z-index: 100;
          box-shadow: 0 2px 12px rgba(0,0,0,0.2); }
    .nav-brand { color: white; font-size: 1.5rem; font-weight: 800; padding: 1rem 0; }
    .nav-brand span { color: #f59e0b; }
    .nav-links { display: flex; gap: 0.5rem; align-items: center; }
    .nav-links a { color: #94a3b8; text-decoration: none; padding: 0.5rem 1rem;
                   border-radius: 6px; font-size: 0.9rem; transition: all 0.2s; }
    .nav-links a:hover { color: white; background: #334155; }
    .btn-post { background: #f59e0b !important; color: #1e293b !important;
                font-weight: 700 !important; }

    .hero { background: linear-gradient(135deg, #1e293b 0%, #0f4c75 50%, #1e293b 100%);
            padding: 5rem 2rem; text-align: center; position: relative; overflow: hidden; }
    .hero::before { content: ''; position: absolute; inset: 0;
                    background: radial-gradient(circle at 50% 50%,
                    rgba(245,158,11,0.15) 0%, transparent 70%); }
    .hero h1 { color: white; font-size: 3rem; font-weight: 900;
               margin-bottom: 1rem; position: relative; line-height: 1.2; }
    .hero h1 span { color: #f59e0b; }
    .hero p { color: #94a3b8; font-size: 1.15rem; max-width: 550px;
              margin: 0 auto 2.5rem; position: relative; }
    .search-bar { display: flex; max-width: 580px; margin: 0 auto;
                  position: relative; box-shadow: 0 8px 32px rgba(0,0,0,0.3); }
    .search-bar input { flex: 1; padding: 1rem 1.5rem; border: none;
                        border-radius: 10px 0 0 10px; font-size: 1rem; outline: none; }
    .search-bar button { background: #f59e0b; color: #1e293b; border: none;
                         padding: 0 2rem; border-radius: 0 10px 10px 0;
                         font-weight: 800; cursor: pointer; font-size: 1rem; }
    .search-bar button:hover { background: #d97706; }

    .stats-bar { background: white; padding: 1.5rem 2rem;
                 display: flex; justify-content: center; gap: 3rem;
                 border-bottom: 1px solid #e2e8f0; }
    .stat-item { text-align: center; }
    .stat-num { font-size: 1.8rem; font-weight: 800; color: #f59e0b; }
    .stat-label { font-size: 0.8rem; color: #64748b; margin-top: 0.2rem; }

    .filter-bar { background: white; padding: 1rem 2rem;
                  display: flex; gap: 0.5rem; flex-wrap: wrap;
                  border-bottom: 1px solid #e2e8f0; justify-content: center; }
    .filter-btn { padding: 0.4rem 1.1rem; border-radius: 999px; border: none;
                  cursor: pointer; font-size: 0.85rem; font-weight: 600;
                  background: #f1f5f9; color: #64748b; transition: all 0.2s; }
    .filter-btn:hover, .filter-btn.active { background: #1e293b; color: white; }

    .container { max-width: 1100px; margin: 2rem auto; padding: 0 1rem; }
    .section-title { font-size: 1.2rem; font-weight: 700; color: #1e293b;
                     margin-bottom: 1.5rem; display: flex; align-items: center; gap: 0.8rem; }
    .section-title::after { content: ''; flex: 1; height: 2px; background: #e2e8f0; }

    .jobs-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
                 gap: 1.2rem; }
    .job-card { background: white; border-radius: 14px; padding: 1.5rem;
                box-shadow: 0 2px 8px rgba(0,0,0,0.06); cursor: pointer;
                transition: all 0.2s; border: 2px solid transparent; }
    .job-card:hover { border-color: #f59e0b; transform: translateY(-3px);
                      box-shadow: 0 8px 24px rgba(0,0,0,0.12); }
    .job-header { display: flex; justify-content: space-between;
                  align-items: flex-start; margin-bottom: 0.8rem; }
    .company-logo { width: 48px; height: 48px; border-radius: 10px;
                    background: linear-gradient(135deg, #1e293b, #0f4c75);
                    display: flex; align-items: center; justify-content: center;
                    font-size: 1.3rem; flex-shrink: 0; }
    .job-type-badge { padding: 0.25rem 0.8rem; border-radius: 999px;
                      font-size: 0.75rem; font-weight: 700; }
    .type-full { background: #dcfce7; color: #15803d; }
    .type-part { background: #dbeafe; color: #1d4ed8; }
    .type-remote { background: #f3e8ff; color: #7c3aed; }
    .type-contract { background: #fef3c7; color: #d97706; }
    .type-other { background: #f1f5f9; color: #475569; }
    .job-title { font-size: 1.05rem; font-weight: 700; color: #1e293b;
                 margin-bottom: 0.3rem; line-height: 1.3; }
    .job-company { font-size: 0.88rem; color: #64748b; margin-bottom: 0.8rem; }
    .job-meta { display: flex; gap: 1rem; flex-wrap: wrap; }
    .meta-tag { font-size: 0.78rem; color: #94a3b8;
                display: flex; align-items: center; gap: 0.3rem; }
    .job-footer { margin-top: 1rem; padding-top: 1rem; border-top: 1px solid #f1f5f9;
                  display: flex; justify-content: space-between; align-items: center; }
    .salary { font-size: 0.85rem; font-weight: 700; color: #f59e0b; }
    .btn-apply { background: #1e293b; color: white; border: none; padding: 0.45rem 1rem;
                 border-radius: 7px; font-size: 0.82rem; cursor: pointer;
                 font-weight: 600; text-decoration: none; }
    .btn-apply:hover { background: #334155; }

    .empty-state { text-align: center; padding: 4rem; color: #94a3b8; }
    .empty-icon { font-size: 4rem; margin-bottom: 1rem; }
    .loading { text-align: center; padding: 4rem; }
    .spinner { width: 40px; height: 40px; border: 3px solid #e2e8f0;
               border-top-color: #f59e0b; border-radius: 50%;
               animation: spin 0.8s linear infinite; margin: 0 auto 1rem; }
    @keyframes spin { to { transform: rotate(360deg); } }

    footer { background: #1e293b; color: #64748b; padding: 2rem;
             text-align: center; margin-top: 3rem; font-size: 0.85rem; }
    footer span { color: #f59e0b; }
  </style>
</head>
<body>

  <nav>
    <div class="nav-brand">Job<span>Hive</span></div>
    <div class="nav-links">
      <a href="/">Home</a>
      <a href="/jobs">Browse Jobs</a>
      <a href="/apply" class="btn-post">üì© Apply Now</a>
    </div>
  </nav>

  <div class="hero">
    <h1>Find Your<br/><span>Dream Job</span></h1>
    <p>Connect with top companies in East Java. Your next career opportunity is just one click away.</p>
    <div class="search-bar">
      <input type="text" id="search-input" placeholder="Search job title or company..."/>
      <button onclick="searchJobs()">üîç Search</button>
    </div>
  </div>

  <div class="stats-bar">
    <div class="stat-item">
      <div class="stat-num" id="stat-jobs">-</div>
      <div class="stat-label">Active Jobs</div>
    </div>
    <div class="stat-item">
      <div class="stat-num" id="stat-apps">-</div>
      <div class="stat-label">Applications</div>
    </div>
    <div class="stat-item">
      <div class="stat-num" id="stat-companies">-</div>
      <div class="stat-label">Companies</div>
    </div>
  </div>

  <div class="filter-bar">
    <button class="filter-btn active" onclick="filterType('', this)">All Types</button>
    <button class="filter-btn" onclick="filterType('Full-time', this)">üíº Full-time</button>
    <button class="filter-btn" onclick="filterType('Part-time', this)">‚è∞ Part-time</button>
    <button class="filter-btn" onclick="filterType('Remote', this)">üè† Remote</button>
    <button class="filter-btn" onclick="filterType('Contract', this)">üìã Contract</button>
  </div>

  <div class="container">
    <div class="section-title">üî• Latest Opportunities</div>
    <div id="jobs-container">
      <div class="loading">
        <div class="spinner"></div>
        <p style="color:#94a3b8">Loading jobs...</p>
      </div>
    </div>
  </div>

  <footer>
    <p>¬© 2025 <span>JobHive</span> ‚Äî East Java's Premier Job Board</p>
    <p style="margin-top:0.5rem">Powered by AWS EC2, SQS & DynamoDB</p>
  </footer>

  <script>
    let allJobs = [];
    let activeType = '';

    const typeClass = {
      'Full-time': 'type-full',
      'Part-time': 'type-part',
      'Remote': 'type-remote',
      'Contract': 'type-contract'
    };

    function formatDate(iso) {
      return new Date(iso).toLocaleDateString('en-US', {
        day: 'numeric', month: 'short', year: 'numeric'
      });
    }

    async function loadStats() {
      try {
        const res = await fetch('/api/jobs/stats/summary');
        const data = await res.json();
        if (data.success) {
          document.getElementById('stat-jobs').textContent = data.data.total_jobs;
          document.getElementById('stat-apps').textContent = data.data.total_applications;
          const companies = new Set(allJobs.map(j => j.company)).size;
          document.getElementById('stat-companies').textContent = companies;
        }
      } catch (err) {
        console.error('Stats error:', err.message);
      }
    }

    async function loadJobs() {
      try {
        const res = await fetch('/api/jobs');
        const data = await res.json();
        allJobs = data.data || [];
        renderJobs(allJobs);
        loadStats();
      } catch (err) {
        document.getElementById('jobs-container').innerHTML =
          `<div class="empty-state"><div class="empty-icon">‚ö†Ô∏è</div>
           <p style="color:#ef4444">Failed to load jobs: ${err.message}</p></div>`;
      }
    }

    function renderJobs(jobs) {
      const container = document.getElementById('jobs-container');
      if (jobs.length === 0) {
        container.innerHTML = `
          <div class="empty-state">
            <div class="empty-icon">üì≠</div>
            <p>No jobs found matching your criteria.</p>
          </div>`;
        return;
      }
      container.innerHTML = `
        <div class="jobs-grid">
          ${jobs.map(j => `
            <div class="job-card" onclick="window.location='/apply?job_id=${j.id}&title=${encodeURIComponent(j.title)}&company=${encodeURIComponent(j.company)}'">
              <div class="job-header">
                <div class="company-logo">üè¢</div>
                <span class="job-type-badge ${typeClass[j.type] || 'type-other'}">${j.type}</span>
              </div>
              <div class="job-title">${j.title}</div>
              <div class="job-company">üè¢ ${j.company}</div>
              <div class="job-meta">
                <span class="meta-tag">üìç ${j.location}</span>
                <span class="meta-tag">üìÖ ${formatDate(j.posted_at)}</span>
              </div>
              <div class="job-footer">
                <span class="salary">üí∞ ${j.salary || 'Competitive'}</span>
                <a class="btn-apply"
                   href="/apply?job_id=${j.id}&title=${encodeURIComponent(j.title)}&company=${encodeURIComponent(j.company)}"
                   onclick="event.stopPropagation()">
                  Apply ‚Üí
                </a>
              </div>
            </div>
          `).join('')}
        </div>`;
    }

    function filterType(type, btn) {
      activeType = type;
      document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
      btn.classList.add('active');
      applyFilters();
    }

    function searchJobs() { applyFilters(); }

    function applyFilters() {
      const query = document.getElementById('search-input').value.toLowerCase();
      let filtered = allJobs;
      if (activeType) filtered = filtered.filter(j => j.type === activeType);
      if (query) filtered = filtered.filter(j =>
        j.title.toLowerCase().includes(query) ||
        j.company.toLowerCase().includes(query) ||
        j.location.toLowerCase().includes(query)
      );
      renderJobs(filtered);
    }

    document.getElementById('search-input').addEventListener('keyup', e => {
      if (e.key === 'Enter') searchJobs();
    });

    loadJobs();
  </script>
</body>
</html>
